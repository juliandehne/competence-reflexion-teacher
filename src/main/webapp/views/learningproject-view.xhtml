<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:pe="http://primefaces.org/ui/extensions">

	<!-- Here the learning projected can be edited			 -->
	<p:panel id="learningProjectEdit"
		rendered="#{templateCompetenceView.learningTemplateResultSet != null}">
		<h2>
			Lernprojekt:
			<p:inplace editor="true"
				label="#{templateCompetenceView.learningTemplateResultSet.nameOfTheLearningTemplate}">
				<p:inputText value="#{learningTemplateView.tmpName}"
					placeholder="#{templateCompetenceView.learningTemplateResultSet.nameOfTheLearningTemplate}" />
				<p:ajax event="save" update="learningTemplatePorlet" process="@this"
					listener="#{learningTemplateView.renameLearningTemplate(templateCompetenceView.learningTemplateResultSet.nameOfTheLearningTemplate)}" />
			</p:inplace>

			<span class="pull-right" style="font-size: 15px;"> <p:commandButton
					value="Lernprojekt löschen" icon="ui-icon-closethick" ajax="true"
					update="learningTemplatePorlet"
					actionListener="#{learningTemplateView.deleteLearningTemplate(templateCompetenceView.learningTemplateResultSet.nameOfTheLearningTemplate)}">
					<p:confirm header="Löschen bestätigen"
						message="Möchten Sie dieses Lernprojekt wirklich löschen?"
						icon="ui-icon-alert" />
				</p:commandButton>
			</span>
		</h2>
		<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
			<p:commandButton value="Yes" type="button"
				styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
			<p:commandButton value="No" type="button"
				styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
		</p:confirmDialog>
		<hr />


		<!-- In this dialog a new path can be added -->
		<p:dialog header="neuer Lernpfad hinzufügen"
			widgetVar="newCompetenceDialog" modal="true" height="100%"
			closeOnEscape="true">
			<div class="centered marginTop">
				<div class="marginTop">
					<h:outputText value="Geben Sie zwei Kompetenzen ein! " />
				</div>
				<div class="marginTop">
					erste Kompetenz:
					<p:inputText value="#{templateCompetenceView.firstNewCompetence}" />
				</div>
				<div class="marginTop">
					zweite Kompetenz:
					<p:inputText value="#{templateCompetenceView.secondNewCompetence}" />
				</div>
				<div class="marginTop">
					<p:commandButton value="erstellen" icon="ui-icon-check"
						update="learningProjectEdit" resetValues="true"
						onstart="PF('statusDialog').show()"
						onsuccess="PF('statusDialog').hide()"
						actionListener="#{templateCompetenceView.addNewCompetence}" />
					<p:commandButton value="abbrechen"
						onclick="PF('newCompetenceDialog').hide()"
						style="margin-left:5px;" />
				</div>
			</div>
		</p:dialog>

		<p:dialog header="Kompetenz bearbeiten"
			widgetVar="editCompetenceDialog" modal="true" height="100%"
			closeOnEscape="true">
			<div class="centered marginTop">
				<p:outputPanel id="editCompetencePanel" layout="block">
					<div class="marginTop">
						<h4>
							<h:outputText
								value="''#{competencenTreeView.selectedNode.data}'' umbenennen: " />
						</h4>
					</div>
					<div class="marginTop">
						Neuer Name:
						<p:inputText value="#{templateCompetenceView.tmpName}"
							placeholder="#{competencenTreeView.selectedNode.data}" />
					</div>
					<hr />
					<div class="marginTop">
						<span class="pull-left"> <p:button icon="ui-icon-plus"
								value="Unter Kompetenzen" onclick="return false">
								<p:effect type="blind" event="click" for="subCompetencePanel">
									<f:param name="mode" value="'show'" />
								</p:effect>
								<p:effect event="click" for="editCompetencePanel">
									<f:param name="mode" value="'hide'" />
								</p:effect>
							</p:button>
						</span> <span class="pull-right"> <p:commandButton
								value="abbrechen" onclick="PF('editCompetenceDialog').hide()"
								style="margin-right:5px;" /> <p:commandButton value="update"
								icon="ui-icon-check" update="learningProjectEdit"
								onstart="PF('statusDialog').show()"
								onsuccess="PF('statusDialog').hide()"
								actionListener="#{templateCompetenceView.renameCompetence}" />
						</span>
					</div>
				</p:outputPanel>

				<!-- Here SubCompetences can be added -->
				<p:outputPanel id="subCompetencePanel" layout="block"
					style="display:none">
					<div class="marginTop">
						<h4>
							<h:outputText
								value="Unterkompetenzen für Kompetenz ''#{competencenTreeView.selectedNode.data}'': " />
						</h4>
						<p:inputText value="#{templateCompetenceView.newSubCompetence}"
							placeholder="neue untere Kompetenz" />
						<p:commandButton update="subCompetenceList"
							actionListener="#{templateCompetenceView.addSubCompetence(competencenTreeView.selectedNode.data)}"
							value="hinzufügen" style="margin-left:5px; margin-bottom: 7px;" />
						<hr />
						<p:dataList id="subCompetenceList"
							value="#{competencenTreeView.getSubCompetences(competencenTreeView.selectedNode)}"
							var="subCompetence">
							<f:facet name="header">
								            Unterkompetenzen
								        </f:facet>
							<p class="ui-li-aside">
								<p:outputLabel value="#{subCompetence}"></p:outputLabel>
							</p>
						</p:dataList>
						<hr />
						<span class="pull-left"> <p:button
								icon="ui-icon-arrowreturnthick-1-w" value="zurück"
								onclick="return false">
								<p:effect type="blind" event="click" for="editCompetencePanel">
									<f:param name="mode" value="'show'" />
								</p:effect>
								<p:effect event="click" for="subCompetencePanel">
									<f:param name="mode" value="'hide'" />
								</p:effect>
							</p:button>
						</span> <span class="pull-right"><p:commandButton
								value="abbrechen" onclick="PF('editCompetenceDialog').hide()"
								style="margin-left:10px;" /></span>
					</div>
				</p:outputPanel>
			</div>
		</p:dialog>
		<p:dialog header="Kompetenz abzweigen"
			widgetVar="branchCompetenceDialog" modal="true" height="170"
			closeOnEscape="true">
			<div class="centered marginTop">
				<div class="marginTop">
					<h:outputText value="Geben Sie neue Kompetenz ein! " />
				</div>
				<div class="marginTop">
					<p:inputText
						value="#{competencenTreeView.selectedCompetenceToNode}" />
				</div>
				<div class="marginTop">
					<p:commandButton value="abzweigen" icon="ui-icon-check"
						update="learningProjectEdit" resetValues="true"
						onstart="PF('statusDialog').show()"
						onsuccess="PF('statusDialog').hide()"
						actionListener="#{templateCompetenceView.branchCompetenceAction}" />
					<p:commandButton value="abbrechen"
						onclick="PF('branchCompetenceDialog').hide()"
						style="margin-left:5px;" />
				</div>
			</div>
			<br />
			<div class="marginTop">
				<i> <p:commandLink value=">>> vorhandene Kompetenz auswählen !"
						onclick="PF('branchCompetenceDialog').hide();PF('branchCompetenceDbDialog').show();" />
				</i>
			</div>
		</p:dialog>

		<p:dialog header="neues Kompetenzniveau"
			widgetVar="newLevelCompetenceDialog" modal="true" height="140"
			closeOnEscape="true">
			<div class="centered marginTop">
				<div class="marginTop">
					<h:outputText value="Geben Sie neues Kompetenzniveau ein: " />
				</div>
				<div class="marginTop">
					<p:inputText value="#{competencenTreeView.newLevelCompetence}" />
				</div>
				<div class="marginTop">
					<p:commandButton value="erstellen" icon="ui-icon-check"
						update="learningProjectEdit" resetValues="true"
						onstart="PF('statusDialog').show()"
						onsuccess="PF('statusDialog').hide()"
						actionListener="#{templateCompetenceView.addNewCompetenceLevel}" />
					<p:commandButton value="abbrechen"
						onclick="PF('newLevelCompetenceDialog').hide()"
						style="margin-left:5px;" />
				</div>
			</div>
			<br />
		</p:dialog>


		<p:dialog header="Vorhandene Kompetenz auswählen"
			widgetVar="branchCompetenceDbDialog" modal="true" height="120"
			closeOnEscape="true">
			<div class="centered marginTop">
				<div class="marginTop">
					<h:outputText value="Wählen Sie eine Kompetenz aus! " />
				</div>
				<div class="marginTop">
					<p:autoComplete maxResults="10" dropdown="true"
						value="#{templateCompetenceView.selectedDbCompetence}"
						completeMethod="#{templateCompetenceView.complete}" />
				</div>
				<div class="marginTop">
					<p:commandButton value="abzweigen" icon="ui-icon-check"
						update="learningProjectEdit"
						actionListener="#{templateCompetenceView.branchCompetenceFromDbAction}" />
					<p:commandButton value="abbrechen"
						onclick="PF('branchCompetenceDbDialog').hide()"
						style="margin-left:5px;" />
				</div>
			</div>
		</p:dialog>

	<ui:include src="competence-view.xhtml" />

	</p:panel>

</ui:composition>