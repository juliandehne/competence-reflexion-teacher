<ui:composition
			xmlns="http://www.w3.org/1999/xhtml"
			xmlns:c="http://java.sun.com/jsp/jstl/core"
			xmlns:f="http://java.sun.com/jsf/core"
			xmlns:h="http://java.sun.com/jsf/html"
			xmlns:p="http://primefaces.org/ui"
			xmlns:ui="http://java.sun.com/jsf/facelets"
			xmlns:pe="http://primefaces.org/ui/extensions">
				
	<table class="table table-bordered table-hover table-condensed table-striped">
		<thead>
			<tr>
				<th>#</th>
				<th>Kompetenze:</th>
				<ui:repeat var="suggestedCompetenceColumn"
					value="#{competencenTableView.suggestedCompetenceGrid.suggestedCompetenceRows[0].suggestedCompetenceColumns}"
					varStatus="varStatus">
					<th>Niveau #{varStatus.index +1}</th>
				</ui:repeat>
			</tr>
		</thead>
	
		<ui:repeat var="suggestedCompetenceRow"
			value="#{competencenTableView.suggestedCompetenceGrid.suggestedCompetenceRows}"
			id="gridView" varStatus="varStatus">
			<tr>
				<td>#{varStatus.index +1}</td>
				<td><b><h:outputText class="suggestedCompetenceRowHeader}"
						value="#{suggestedCompetenceRow.suggestedCompetenceRowHeader}"></h:outputText></b>
				</td>
	
				<ui:repeat var="suggestedCompetenceColumn" value="#{suggestedCompetenceRow.suggestedCompetenceColumns}">
					<td>
						<div class="ui-grid-row">
							<span class="ui-grid-col-6">
								<h:outputText class="competenceGridEntry"
									value="#{suggestedCompetenceColumn.testOutput}" />
							</span>
							<span class="ui-grid-col-6">
								<p:commandButton value="Aktivitäten"
									onclick="PF('activityCompetenceDialog').show()"
									action="#{competencenTableView.selecteCompetence(suggestedCompetenceColumn.testOutput)}"
									style="font-size: 12px; font-style: italic;">
									<p:ajax onsuccess="updateActivityFromCompetenceDialog()" />
								</p:commandButton>
<!-- 								<p:commandButton value="Kurs" type="button" -->
<!-- 									style="font-size: 12px; font-style: italic;"/> -->
							</span>
						</div>
						<p:outputPanel rendered="#{competencenTableView.getCourseFromCompetence(suggestedCompetenceColumn.testOutput) != null}">
								<!-- <i>(Kurse: </i>#{competencenTableView.getCourseFromCompetence(suggestedCompetenceColumn.testOutput)}
								<ui:repeat var="course" value="#{competencenTableView.getCourseFromCompetence(suggestedCompetenceColumn.testOutput)}">
									<p:commandLink onclick="PF('activityCourseDialog').show()" 
											actionListener="#{competencenTableView.selecteCourse(course.courseid)}">
										#{course.name}
									</p:commandLink>,
								</ui:repeat>
								<i>)</i> -->
						</p:outputPanel>
					</td>
				</ui:repeat>
			</tr>
		</ui:repeat>
	</table>
	
	<p:button id="activityOrderButton" icon="ui-icon-plus" value="Aktivität zuordnen" onclick="return false">
		<p:effect type="fade" event="click" for="activityManagerPanel">
			<f:param name="mode" value="'show'" />
		</p:effect>
		<p:effect type="fade" event="click" for="activityOrderButton">
			<f:param name="mode" value="'hide'" />
		</p:effect>
	</p:button>
	
	<p:outputPanel id="activityManagerPanel" layout="block" style="display:none">

	<p:button value="abbrechen" onclick="return false" style="margin-left:5px;">
		<p:effect type="fade" event="click" for="activityManagerPanel">
			<f:param name="mode" value="'hide'" />
		</p:effect>
		<p:effect type="fade" event="click" for="activityOrderButton">
			<f:param name="mode" value="'show'" />
		</p:effect>
	</p:button>

	<!-- Activity manager panel: -->
	<p:outputPanel id="competencePanelViewForActivity">
	
		<div class="ui-grid-row">
			<div class="ui-grid-col-4">
				<h5>Wählen Sie bitte einen Aktivität aus: </h5>
				<p:tree value="#{activityCompetenceView.activityTreeRoot}" var="node" 
					selectionMode="single" selection="#{activityCompetenceView.selectedActivityNode}"
					dynamic="true" style="width:100%">
					<p:treeNode >
						<h:outputText value="#{node.name}" />
					</p:treeNode>
				</p:tree>
				<div class="pull-right marginTop">
					<p:commandButton value="Aktivität auswählen" update="competencePanelViewForActivity" />
				</div>
			</div>
			
			<p:outputPanel id="competenceActivitySelecteTree" rendered="#{activityCompetenceView.selectedActivityNode != null}">
				<div class="ui-grid-col-4 border-left-right">
					<h5>Wählen Sie bitte die Kompetenzen aus: </h5>
					<div class="marginTop">
						<p:scrollPanel mode="native" style="width:auto;height:300px">
						<p:tree value="#{activityCompetenceView.competenceTreeRoot}" var="node" 
							selectionMode="checkbox" selection="#{activityCompetenceView.selectedKompetenceNodes}"
							dynamic="true" style="width:100%">
							<p:treeNode >
								<h:outputText value="#{node}" />
							</p:treeNode>
						</p:tree>
						</p:scrollPanel>
					</div>
				</div>
				
				<div class="ui-grid-col-3 centered">
					<div>
						<h:outputText value="ausgewählte Aktivität: #{activityCompetenceView.selectedActivityNode.data.name}" />
					</div>
					<ul>
						<ui:repeat var="selectedCompetence" value="#{activityCompetenceView.selectedKompetenceNodes}">
							<li><h:outputText value="#{selectedCompetence}" /></li>
						</ui:repeat>
					</ul>
<!-- 					<p:commandButton value="Aktivität zuordnen" update="competencePanelViewForActivity"  -->
<!-- 						actionListener="#{activityCompetenceView.activityCompetenceCollate}"/> -->
				</div>
			</p:outputPanel> 
			
			<!-- Hier werden bei Button-Click dynamisch Assessment-Fragen angezeigt process="@(.reflexionSelection)" -->
			<p:panel id="reflexionSelection" styleClass="reflexionSelection">
				<div id="assessmentsForSelected" class="ui-grid ui-grid-responsive">
					<H2></H2>
					<br />
					<ui:repeat var="reflectiveAssessment"
						value="#{GridViewController.holder.reflectiveAssessmentList}">
						<div class="flexiflex ui-grid-row" style="margin: auto;">
							<div class="ui-grid-col-7">
								<p:outputLabel for="assessmentRadio"
									value="#{reflectiveAssessment.competenceDescription}"></p:outputLabel>
							</div>
							<div class="ui-grid-col-5" style="padding-left: 5px;">
							</div>
						</div>
						<br />
					</ui:repeat>
				</div>
			</p:panel>
		</div>
	</p:outputPanel>
	<!-- End Activity manager panel -->
	</p:outputPanel>
	
	<p:remoteCommand name="updateActivityFromCompetenceDialog" update="activityFromCompetenceDialog"/>
	<p:outputPanel id="panelCompetenceDialog">
		
		<p:dialog header="Aktivitäten" widgetVar="activityCompetenceDialog" 
			 id="activityFromCompetenceDialog"
			modal="true" height="100%" closeOnEscape="true">
			<div class="centered marginTop">
				<div class="marginTop">
					<h:outputText value="Hier ist Liste von Aktivitäten der Kompetenzen: #{competencenTableView.selectedCompetence}" />
				</div>
				<div class="marginTop">

				</div>
				
				<div class="marginTop">
	<!-- 							<p:commandButton value="erstellen" icon="ui-icon-check" /> -->
					<p:commandButton value="abbrechen" onclick="PF('activityCompetenceDialog').hide()" style="margin-left:5px;"/>
				</div>
			</div>
		</p:dialog>
		

<!-- onShow="updateActivityFromCourseDialog()"		<p:remoteCommand name="updateActivityFromCourseDialog" update="activityFromCourseDialog"/> -->
		
		<p:dialog header="Aktivitäten von Kurs" widgetVar="activityCourseDialog"
			 id="activityFromCourseDialog"
			modal="true" height="100%" closeOnEscape="true">
			<div class="centered marginTop">
				<div class="marginTop">
					<h:outputText value="Aktivitäten von Course:" />
				</div>
				<div class="marginTop">
					<ui:repeat var="activity" value="#{competencenTableView.getActivityFromCourse()}">
						<img src="#{activity.icon}" />
						<h:outputText value="#{activity.name} " />
						<br />
					</ui:repeat>
				</div>
				
				<div class="marginTop">
	<!-- 							<p:commandButton value="erstellen" icon="ui-icon-check" /> -->
					<p:commandButton value="abbrechen" onclick="PF('activityCourseDialog').hide()" style="margin-left:5px;"/>
				</div>
			</div>
		</p:dialog>
		
	</p:outputPanel>	
</ui:composition>