<?xml version="1.0"?>

<f:view
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:pe="http://primefaces.org/ui/extensions">
	<h:head>
		<style type="text/css">
			.centered {
			    text-align: center;
			    margin 0 auto;
			}

			.marginTop {
				margin-top: 8px;
			}
		</style>
	</h:head>
	<h:body>

	<h:form id="learningTemplateForm">
		<p:outputPanel id="learningTemplatePorlet">
			<p:panel>
				<div class="ui-grid ui-grid-responsive">
					<div class="ui-grid-row centered">
						<div class="ui-grid-col-12">
							<h4><h:outputText value="Geben Sie einen Namen für das Template an oder wählen sie ein bestehendes aus!" /></h4>
						</div>
					</div>
					<div class="ui-grid-row centered marginTop">
						<div class="ui-grid-row-6">
							<div><h:outputText value="Learning-Template von DB auswählen: " /></div>
							<div class="marginTop">
								<p:autoComplete maxResults="10" id="autocompleteLearningTemplate"
									dropdown="true"
									value="#{learningTemplateView.selectedLearningTemplate}"
									completeMethod="#{learningTemplateView.complete}"
									validator="#{learningTemplateView.validate}"
									validatorMessage="Dieses Lernziel ist nicht vorhanden!">
								</p:autoComplete>
							</div>
							<div class="marginTop">
								<p:commandButton id="templateSelecteButton" value="auswählen" icon="ui-icon-check"
									update="learningTemplatePorlet"
									actionListener="#{learningTemplateView.selectLearningTemplate}">
									<f:ajax render="@form" />
								</p:commandButton>
							</div>
						</div>
						<div class="ui-grid-row-6" >
							<p:commandButton icon="ui-icon-plus" value="neu erstellen" ajax="true"
								onclick="PF('newTemplateDialog').show()" style="margin-left:50%; margin-top:20px;"/>
						</div>
					</div>
					<div class="ui-grid-row marginTop">
						<div class="ui-grid-col-12 centered">
							<p:message for="autocompleteLearningTemplate" />
							<p:messages for="selecteCompetenceMessages"/>
						</div>
					</div>
				</div>

				<p:dialog header="neu Lernprojekt erstellen"  closeOnEscape="true"
					widgetVar="newTemplateDialog" modal="true" height="120">
					<div class="centered marginTop">
						<h4><h:outputText value="Geben Sie einen neuen Lernprojekt ein: " /></h4>
						<div class="marginTop">
							<p:inputText id="name" value="#{learningTemplateView.newLearningTemplate}" />
						</div>
						<div class="marginTop">
							<p:commandButton value="erstellen" icon="ui-icon-check"
								ajax="true" keypadOnly="true" resetValues="true"
								update="learningTemplatePorlet"
								oncomplete="PF('newTemplateDialog').hide()"
								actionListener="#{learningTemplateView.createLearningTemplate}">
							</p:commandButton>
							<p:commandButton value="abbrechen" onclick="PF('newTemplateDialog').hide()" style="margin-left:5px;"/>
						</div>
					</div>
				</p:dialog>
			</p:panel>


			<br />
			<br />
			<br />


			<p:panel id="learningProjectEdit" rendered="#{templateCompetenceView.learningTemplateResultSet != null}">
				<p:growl id="growl" showDetail="true" sticky="true" />
				<h2>
					<h:outputText id="selectedLearningProject"
						value="Lernprojekte : #{templateCompetenceView.learningTemplateResultSet.nameOfTheLearningTemplate}" />
				</h2>
				<br />

				<ui:repeat var="catchWord" value="#{competencenTreeView.catchWords}" >
					<h4>
						<h:outputText value="#{catchWord} " />
<!-- 					<p:inplace id="ajax" editor="true"> -->
<!-- 			            <p:inputText value="#{catchWord} " required="true" label="text" /> -->
<!-- 			        </p:inplace> -->
					</h4>

<!-- oncomplete="if(true) { PF('branchCompetenceDialog').show(); }" -->
					<!-- Tree view for competence -->
					<div class="marginTop">
					<ui:repeat var="tree" value="#{competencenTreeView.treeNodeMap.get(catchWord)}">
						<p:tree value="#{tree}" var="node" selectionMode="single" 
							selection="#{competencenTreeView.selectedNode}"
							dynamic="true" orientation="horizontal" >
							<p:ajax event="select" update="@form"
								listener="#{competencenTreeView.onNodeSelect(catchWord)}" />
							<p:treeNode >
								<h:outputText value="#{node}" />
							</p:treeNode>
						</p:tree>
						<br />
					</ui:repeat>
					</div>
		        	<p:commandButton icon="ui-icon-plus" value="neuer Lernpfad" onclick="PF('newCompetenceDialog').show()"
		        		action="#{templateCompetenceView.selecteCatchWord(catchWord)}"/>
			       
			        <hr />
				</ui:repeat>
				


				<p:dialog header="Kompetence hinzufügen" widgetVar="newCompetenceDialog" 
					modal="true" height="100%" closeOnEscape="true" >
					<div class="centered marginTop">
						<div class="marginTop">
							<h:outputText value="Geben Sie zwei Kompetenzen ein! " />
						</div>
						<div class="marginTop">
							erste Kompetenze: 
							<p:inputText value="#{templateCompetenceView.firstNewCompetence}" />
						</div>
						<div class="marginTop">
							zweite Kompetenze: 
							<p:inputText value="#{templateCompetenceView.secondNewCompetence}" />
						</div>
						<div class="marginTop">
							<p:commandButton value="erstellen" icon="ui-icon-check"
								update="learningProjectEdit" resetValues="true"
								actionListener="#{templateCompetenceView.addNewCompetence}" />
							<p:commandButton value="abbrechen" onclick="PF('newCompetenceDialog').hide()" style="margin-left:5px;"/>
						</div>
					</div>
				</p:dialog>
				
<!-- 				<p:dialog header="Kompetence " widgetVar="editCompetenceDialog"  -->
<!-- 					modal="true" height="100%" closeOnEscape="true" > -->
<!-- 					<div class="centered marginTop"> -->
<!-- 						<div class="marginTop"> -->
<!-- 							<h:outputText value="untere Kompetenzen von ''#{competencenTreeView.selectedNode.data}'' erstellen " /> -->
<!-- 						</div> -->
<!-- 						<div class="marginTop"> -->
<!-- 							Kompetenzename: -->
<!-- 							<p:inputText  /> -->
<!-- 						</div> -->
<!-- 						<div class="marginTop"> -->
<!-- 							Kompetenzeniveau: -->
<!-- 							<p:inputText /> -->
<!-- 						</div> -->
<!-- 						<div class="marginTop"> -->
<!-- 							Evalution: -->
<!-- 							<p:inputText /> -->
<!-- 						</div> -->
<!-- 						<div class="marginTop"> -->
<!-- 							Kompetenzelink: -->
<!-- 							<p:inputText /> -->
<!-- 						</div> -->
<!-- 						<div class="marginTop"> -->
<!-- 							<p:commandButton value="erstellen" icon="ui-icon-check" -->
<!-- 								update="learningProjectEdit" resetValues="true" /> -->
<!-- 							<p:commandButton value="abbrechen" onclick="PF('editCompetenceDialog').hide()" style="margin-left:5px;"/> -->
<!-- 						</div> -->
<!-- 					</div> -->
<!-- 				</p:dialog> -->


				
				<p:dialog header="Kompetence abzweigen" widgetVar="branchCompetenceDialog"
					modal="true" height="170" closeOnEscape="true">
					<div class="centered marginTop">
						<div class="marginTop">
					    	<h:outputText value="Geben Sie neue Kompetenz ein! " />
						</div>
						<div class="marginTop">
							<p:inputText
								value="#{competencenTreeView.selectedCompetenceToNode}" />
						</div>
						<div class="marginTop">
							<p:commandButton value="abzweigen" icon="ui-icon-check"
								update="learningProjectEdit" resetValues="true"
								actionListener="#{templateCompetenceView.branchCompetenceAction}" />
							<p:commandButton value="abbrechen" onclick="PF('branchCompetenceDialog').hide()" style="margin-left:5px;" />
						</div>
					</div>
					<br />
					<div class="marginTop">
						<i>
							<p:commandLink value=">>> Oder aus Datenbank auswählen !" 
								onclick="PF('branchCompetenceDialog').hide();PF('branchCompetenceDbDialog').show();" />
						</i>
					</div>
				</p:dialog>
				
				<p:dialog header="neues Kompetenceniveau" widgetVar="newLevelCompetenceDialog"
					modal="true" height="140" closeOnEscape="true">
					<div class="centered marginTop">
						<div class="marginTop">
					    	<h:outputText value="Geben Sie neue Kompetenz ein! " />
						</div>
						<div class="marginTop">
							<p:inputText
								value="#{competencenTreeView.newLevelCompetence}" />
						</div>
						<div class="marginTop">
							<p:commandButton value="neues Niveau" icon="ui-icon-check"
								update="learningProjectEdit" resetValues="true"
								actionListener="#{templateCompetenceView.addNewCompetenceLevel}" />
							<p:commandButton value="abbrechen" onclick="PF('newLevelCompetenceDialog').hide()" style="margin-left:5px;" />
						</div>
					</div>
					<br />
				</p:dialog>
				
				
				<p:dialog header="Kompetence von Datenbank abzweigen" widgetVar="branchCompetenceDbDialog"
					modal="true" height="120" closeOnEscape="true">
					<div class="centered marginTop">
						<div class="marginTop">
					    	<h:outputText value="Wählen Sie eine Kompetenz aus! " />
						</div>
						<div class="marginTop">

							<p:autoComplete maxResults="10"
								dropdown="true"
								value="#{templateCompetenceView.selectedDbCompetence}"
								completeMethod="#{templateCompetenceView.complete}"/>
						</div>
						<div class="marginTop">
							<p:commandButton value="abzweigen" icon="ui-icon-check"
								update="learningProjectEdit"
								actionListener="#{templateCompetenceView.branchCompetenceFromDbAction}" />
							<p:commandButton value="abbrechen" onclick="PF('branchCompetenceDbDialog').hide()" style="margin-left:5px;" />
						</div>
					</div>
				</p:dialog>



				<p:button icon="ui-icon-plus" value="Thema hinzufügen" onclick="return false">
					<p:effect type="fade" event="click" for="newHeadField">
						<f:param name="mode" value="'show'" />
					</p:effect>
				</p:button>

				<br />
				<h:panelGroup layout="block" id="newHeadField" style="display:none">
					<fieldset>
					<legend>Geben sie eine Thema ein! :</legend>
						<div class="ui-grid">
							<div class="ui-grid-row">
								<div class="ui-grid-col-3">
									Thema:
								</div>
								<div class="ui-grid-col-6">
									<p:inputText placeholder="neu Thema" 
										value="#{catchwordCreater.newCatchWord}" />
								</div>
							</div>
							<div class="ui-grid-row">
								<div class="ui-grid-col-3">
									Operation:
								</div>
								<div class="ui-grid-col-6">
									<p:inputText placeholder="Operation" 
										value="#{catchwordCreater.newOperation}"/>
								</div>
							</div>
							<div class="ui-grid-row">
								<div class="ui-grid-col-3">
									erste Kompetenze:
								</div>
								<div class="ui-grid-col-6">
									<p:inputText placeholder="erste Kompetenze" 
										value="#{catchwordCreater.firstCompetence}"/>
								</div>
							</div>
							<div class="ui-grid-row">
								<div class="ui-grid-col-3">
									zweite Kompetenze:
								</div>
								<div class="ui-grid-col-6">
									<p:inputText placeholder="zweite Kompetenze" 
										value="#{catchwordCreater.secondCompetence}"/>
								</div>
							</div>
							<div class="ui-grid-row">
								<p:commandButton value="erstellen" icon="ui-icon-check"
									update="learningProjectEdit" resetValues="true"
									actionListener="#{templateCompetenceView.addNewCatchWord}" />
								<p:button value="abbrechen" onclick="return false" style="margin-left:5px;">
									<p:effect type="fade" event="click" for="newHeadField">
										<f:param name="mode" value="'hide'" />
									</p:effect>
								</p:button>
							</div>
						</div>
					</fieldset>
				</h:panelGroup>
			</p:panel>
		</p:outputPanel>
		</h:form>
	</h:body>
</f:view>
